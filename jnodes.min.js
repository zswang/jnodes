!function(n){function e(n){if(!n||"string"!=typeof n)return n;var e=b[n];return e||(e=n.indexOf("-")<0&&n.indexOf("_")<0?n:n.replace(/[-_]+([a-z])/gi,function(n,e){return e.toUpperCase()}),b[n]=e,e)}function r(n,e,r){var o={id:s++,model:n,root:r,render:function(r){return e(n,r,o)}};return p[o.id]=o,t(n),o}function t(n){function e(e,r){var t=Object.getOwnPropertyDescriptor(n,e);if(!t||!1!==t.configurable){var o=t&&t.get,i=t&&t.set;Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){return o?o.call(n):r},set:function(e){e!==(o?o.call(n):r)&&(i?i.call(n,e):r=e,u(n))}})}}d.indexOf(n)>=0||(d.push(n),Array.isArray(n)?["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(e){var r=n[e];Object.defineProperty(n,e,{value:function(){var e=r.apply(this,arguments);return u(n),e},enumerable:!1,writable:!0,configurable:!0})}):Object.keys(n).forEach(function(r){e(r,n[r])}))}function o(n){var e=p[n];if(e){var r=document.querySelector('[bind="'+n+'"]');if(!r)return void delete p[n];var t=[];!0!==e.render(t)&&(l.updateElement?l.updateElement(r,t.join("")):(console.log(r),r.outerHTML=t.join("")))}}function i(n){var e;if("string"==typeof n){if(e=p[r])return e.model}else for(;n;){var r=n.getAttribute("bind");if(r&&(e=p[r]))return e.model;n=n.parentNode}}function u(n){Object.keys(p).forEach(function(e){var r=p[e];r&&r.model===n&&(r.root?r.render():o(e))})}function f(n){return n&&[/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\/>[^\S\n]*)$/gm,/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)>.*<\/\2>[^\S\n]*)$/gm,/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)>[^\S\n]*$[^]*?^\1<\/\2>[^\S\n]*)$/gm].forEach(function(e){n=String(n).replace(e,function(n,e,r,t,o,i,u){var f="\n";return f+=[e,"<% jnodes.bind(",i,", function(",i,", __output, _scope_) { var __append = __output.push.bind(__output); %>","\n"].join(""),f+=[e,"<",r,t,"bind","=",o,"<%= _scope_.id %>",u,"\n"].join(""),f+=[e,"<% }).render(__output); %>","\n"].join("")})}),n}function c(n){return n&&[/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\/>[^\S\n]*)$/gm,/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)>.*<\/\2>[^\S\n]*)$/gm,/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)>[^\S\n]*$[^]*?^\1<\/\2>[^\S\n]*)$/gm].forEach(function(e){n=String(n).replace(e,function(n,e,r,t,o,i,u){var f="\n";return f+=[e,"jnodes.bind(",i,", function(",i,", _output_, _scope_) {","\n"].join(""),f+=[e,"<",r,t,"bind=",o,"#{_scope_.id}",u,"\n"].join(""),f+=[e,"}).render(_output_);","\n"].join("")})}),n}var a={},s=0,p={},d=[],l={},b={},g=function(n,r,t){return function(o,i){if("string"==typeof o||"number"==typeof o)r(t?e(o):o,i);else if("object"==typeof o)if(o instanceof Array)o.forEach(function(n,e){r(e,n)});else for(var u in o)r(t?e(u):u,o[u]);return n}}(l,function(n,e){l[n]=e});a.set=g;var j=function(n,r,t){var o=function(i,u){var f,c;if("function"==typeof i)return c=i["-jsets-params"],c||(c=[],String(i).replace(/\(\s*([^()]+?)\s*\)/,function(n,e){c=e.split(/\s*,\s*/)}),i["-jsets-params"]=c),o(c,i);if("string"==typeof i||"number"==typeof i)return i=t?e(i):i,"function"==typeof u?(u.call(n,r(i)),n):r(i);if("object"==typeof i){if(i instanceof Array)return"function"==typeof u?(f=[],i.forEach(function(n){f.push(r(t?e(n):n))}),u.apply(n,f),n):(f={},i.forEach(function(n){f[n]=r(t?e(n):n)}),f);var a;if("function"==typeof u){f=[];for(a in i)f.push(r(t?e(a):a)||i[a]);return n}f={};for(a in i)f[a]=r(t?e(a):a)||i[a];return f}};return o}(l,function(n){return l[n]});a.get=j,a.bind=r,a.update=o,a.data=i,a.trigger=u,g("ejs",function(n,e){return ejs.render(f(n),e)}),g("jhtmls",function(n,e){return jhtmls.render(c(n),e)}),window.jnodes=a}();
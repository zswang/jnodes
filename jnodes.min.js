!function(e){function n(e,n,r){var i={id:a++,model:e,root:r,render:function(t){return n(e,t,i)}};return d[i.id]=i,t(e),i}function t(e){function n(n,t){var r=Object.getOwnPropertyDescriptor(e,n);if(!r||!1!==r.configurable){var i=r&&r.get,o=r&&r.set;Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:function(){return i?i.call(e):t},set:function(n){n!==(i?i.call(e):t)&&(o?o.call(e,n):t=n,u(e))}})}}p.indexOf(e)>=0||(p.push(e),Array.isArray(e)?["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(n){var t=e[n];Object.defineProperty(e,n,{value:function(){var n=t.apply(this,arguments);return u(e),n},enumerable:!1,writable:!0,configurable:!0})}):Object.keys(e).forEach(function(t){n(t,e[t])}))}function r(e){var n=d[e];if(n){var t=s.findElement(e);if(!t)return void delete d[e];var r=[];!0!==n.render(r)&&s.updateElement(t,r.join(""))}}function i(e){var n;if("string"==typeof e){if(n=d[e])return n.model}else for(;e;){var t=i(e.getAttribute("bind"));if(t)return t;e=e.parentNode}}function u(e){Object.keys(d).forEach(function(n){var t=d[n];t&&t.model===e&&(t.root?t.render():r(n))})}function o(e,n){return e&&n.forEach(function(n){e=String(e).replace(n,function(e,n,t,r,i,u,o,f){var c="\n";return c+=[n,"<% jnodes.bind(",o,", function(",o,", __output, _scope_) { var __append = __output.push.bind(__output); %>","\n"].join(""),c+=[n,"<",t,r,i,"=",u,"<%= _scope_.id %>",f,"\n"].join(""),c+=[n,"<% }).render(__output); %>","\n"].join("")})}),e}function f(e,n){return e&&n.forEach(function(n){e=String(e).replace(n,function(e,n,t,r,i,u,o,f){var c="\n";return c+=[n,"jnodes.bind(",o,", function(",o,", _output_, _scope_) {","\n"].join(""),c+=[n,"<",t,r,i,"=",u,"#{_scope_.id}",f,"\n"].join(""),c+=[n,"}).render(_output_);","\n"].join("")})}),e}var c={},a=0,d={},p=[],l={},s={bindAttributeName:"bind",findElement:function(e){return document.querySelector("["+s.bindAttributeName+'="'+e+'"]')},updateElement:function(e,n){e.outerHTML=n},getReplacements:function(){if(l.attributeName!==s.bindAttributeName){var e="^([^\\S\\n]*)<([\\w-]+)((?:(?:'[^']*'|\"[^\"]*\"|[^'\"\\/>]+)*)\\s)("+s.bindAttributeName+")=(\"|')([$\\w]+)(\\5(?:(?:'[^']*'|\"[^\"]*\"|[^'\"\\/>]+)*)";l.value=[new RegExp(e+"\\/>[^\\S\\n]*)$","mg"),new RegExp(e+">.*<\\/\\2>[^\\S\\n]*)","mg"),new RegExp(e+">[^\\S\\n]*$[^]*?^\\1<\\/\\2>[^\\S\\n]*)$","mg")],l.attributeName=s.bindAttributeName}return l.value}},b=function(e,n){s[e]=n};c.set=b;var m=function(e){return s[e]};c.get=m,c.bind=n,c.data=i,c.trigger=u,b("ejs",function(e,n){return ejs.render(o(e,s.getReplacements()),n)}),b("jhtmls",function(e,n){return jhtmls.render(f(e,s.getReplacements()),n)}),"function"==typeof define?(define.amd||define.cmd)&&define(function(){return c}):"undefined"!=typeof module&&module.exports?module.exports=c:window.jnodes=c}();
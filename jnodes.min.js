!function(n){function e(n){if(!n||"string"!=typeof n)return n;var e=b[n];return e||(e=n.indexOf("-")<0&&n.indexOf("_")<0?n:n.replace(/[-_]+([a-z])/gi,function(n,e){return e.toUpperCase()}),b[n]=e,e)}function t(n,e,t){var i={id:s++,model:n,root:t,render:function(t){return e(n,t,i)}};return d[i.id]=i,r(n),i}function r(n){function e(e,t){var r=Object.getOwnPropertyDescriptor(n,e);if(!r||!1!==r.configurable){var i=r&&r.get,o=r&&r.set;Object.defineProperty(n,e,{enumerable:!0,configurable:!0,get:function(){return i?i.call(n):t},set:function(e){e!==(i?i.call(n):t)&&(o?o.call(n,e):t=e,u(n))}})}}p.indexOf(n)>=0||(p.push(n),Array.isArray(n)?["push","pop","shift","unshift","splice","sort","reverse"].forEach(function(e){var t=n[e];Object.defineProperty(n,e,{value:function(){var e=t.apply(this,arguments);return u(n),e},enumerable:!1,writable:!0,configurable:!0})}):Object.keys(n).forEach(function(t){e(t,n[t])}))}function i(n){var e=d[n];if(e){var t=document.querySelector('[bind="'+n+'"]');if(!t)return void delete d[n];var r=[];!0!==e.render(r)&&(l.updateElement?l.updateElement(t,r.join("")):t.outerHTML=r.join(""))}}function o(n){var e;if("string"==typeof n){if(e=d[n])return e.model}else for(;n;){var t=o(n.getAttribute("bind"));if(t)return t;n=n.parentNode}}function u(n){Object.keys(d).forEach(function(e){var t=d[e];t&&t.model===n&&(t.root?t.render():i(e))})}function f(n){return n&&[/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\/>[^\S\n]*)$/gm,/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)>.*<\/\2>[^\S\n]*)$/gm,/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)>[^\S\n]*$[^]*?^\1<\/\2>[^\S\n]*)$/gm].forEach(function(e){n=String(n).replace(e,function(n,e,t,r,i,o,u){var f="\n";return f+=[e,"<% jnodes.bind(",o,", function(",o,", __output, _scope_) { var __append = __output.push.bind(__output); %>","\n"].join(""),f+=[e,"<",t,r,"bind","=",i,"<%= _scope_.id %>",u,"\n"].join(""),f+=[e,"<% }).render(__output); %>","\n"].join("")})}),n}function c(n){return n&&[/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\/>[^\S\n]*)$/gm,/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)>.*<\/\2>[^\S\n]*)$/gm,/^([^\S\n]*)<([\w-]+)((?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)\s)bind=("|')([$\w]+)(\4(?:(?:'[^']*'|"[^"]*"|[^'"\/>]+)*)>[^\S\n]*$[^]*?^\1<\/\2>[^\S\n]*)$/gm].forEach(function(e){n=String(n).replace(e,function(n,e,t,r,i,o,u){var f="\n";return f+=[e,"jnodes.bind(",o,", function(",o,", _output_, _scope_) {","\n"].join(""),f+=[e,"<",t,r,"bind=",i,"#{_scope_.id}",u,"\n"].join(""),f+=[e,"}).render(_output_);","\n"].join("")})}),n}var a=a||{},s=0,d={},p=[],l={},b={},y=function(n,t,r){return function(i,o){if("string"==typeof i||"number"==typeof i)t(r?e(i):i,o);else if("object"==typeof i)if(i instanceof Array)i.forEach(function(n,e){t(e,n)});else for(var u in i)t(r?e(u):u,i[u]);return n}}(l,function(n,e){l[n]=e});a.set=y;var m=function(n,t,r){var i=function(o,u){var f,c;if("function"==typeof o)return c=o["-jsets-params"],c||(c=[],String(o).replace(/\(\s*([^()]+?)\s*\)/,function(n,e){c=e.split(/\s*,\s*/)}),o["-jsets-params"]=c),i(c,o);if("string"==typeof o||"number"==typeof o)return o=r?e(o):o,"function"==typeof u?(u.call(n,t(o)),n):t(o);if("object"==typeof o){if(o instanceof Array)return"function"==typeof u?(f=[],o.forEach(function(n){f.push(t(r?e(n):n))}),u.apply(n,f),n):(f={},o.forEach(function(n){f[n]=t(r?e(n):n)}),f);var a;if("function"==typeof u){f=[];for(a in o)f.push(t(r?e(a):a)||o[a]);return n}f={};for(a in o)f[a]=t(r?e(a):a)||o[a];return f}};return i}(l,function(n){return l[n]});a.get=m,a.bind=t,a.update=i,a.data=o,a.trigger=u,y("ejs",function(n,e){return ejs.render(f(n),e)}),y("jhtmls",function(n,e){return jhtmls.render(c(n),e)}),"function"==typeof define?(define.amd||define.cmd)&&define(function(){return a}):"undefined"!=typeof module&&module.exports?module.exports=a:window.jnodes=a}();